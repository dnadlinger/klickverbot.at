<!doctype html> <html lang=en> <head> <meta charset=utf-8> <link rel=stylesheet href='/css/250adbc.css'> <title>Thrift now officially supports D! | David Nadlinger</title> <meta name=viewport content="width=device-width; initial-scale=1.0"> <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML'></script> <link rel="openid.server" href="http://openid.klickverbot.at/"/> <link rel="openid2.provider" href="http://openid.klickverbot.at/"/> </head> <body> <header id=main_header> <h1><span><a href="/">David Nadlinger</a></span></h1> <nav role=navigation> <ul> <li><a href="/blog">Blog</a></li> <li><a href="/code">Code</a></li> <li><a href="/about">About</a></li> </ul> </nav> </header> <div role=main id=main_content> <article class=blog-post> <header> <h1><a href="/blog/2012/03/thrift-now-officially-supports-d/">Thrift now officially supports D!</a></h1> <section class=metadata> on <time datetime="2012-03-27T00:00:00-04:00">27 Mar 2012</time> </section> <ul class=pagenav> <li><a href="/blog/2012/01/getaddrinfo-edge-case-behavior-on-windows-linux-and-osx/">Older</a></li> <li><a href="/blog/2012/05/purity-in-d/">Newer</a></li> </ul> </header> <div class=content> <p class=lead><a href="http://thrift.apache.org">Thrift</a> is a cross-language serialization and RPC framework, originally developed for internal use at Facebook, and now an <a href="http://apache.org">Apache Software Foundation</a> project. I started working on support for the <a href="http://dlang.org">D programming language</a> during <a href="http://www.klickverbot.at/code/gsoc/thrift/">Google Summer of Code 2011</a>, and at the end of last week, the implementation was finally incorporated into the main project.</p> <p>First, let me thank Jake Farrell and everybody else on the Thrift team who was involved in <a href="https://issues.apache.org/jira/browse/THRIFT-1500">THRIFT-1500</a>; reviewing a ~719 kB patch certainly isn’t an easy thing to do. But now that the work is in, what can you (as a Thrift user) expect from the implementation?</p> <p>Feature-wise, the library should roughly be up to par with the other major implementations (i.e. C++ and Java):</p> <ul> <li><p><em>Protocols:</em> Binary, Compact and JSON. The Dense protocol has not been implemented yet – it is only supported by the C++ implementation and I am not sure about its relevance nowadays (but if you are at a certain well-known company and it turns out that you still need the feature for new projects, let me know; adding support for it should not be hard).</p></li> <li><p><em>Transports:</em> Socket, SSL, HTTP and log file reader/writer implementations (plus your familiar helpers, i.e. buffered/framed/memory-buffer/piped/zlib...)</p></li> <li><p><em>Servers:</em> several single- and multithreaded variants (including a libevent-based non-blocking implementation)</p></li> <li><p><em>Clients:</em> Both a synchronous and an asynchronous (future-based interface with one or more libevent-backed worker threads) implementation are provided. Additionally, several pooling implementations for redundancy as well as aggregation use cases are available.</p></li> </ul> <p>The implementation makes heavy use of D’s metaprogramming capatibilties and is also able to work without code generated off-line from <code>.thrift</code> files, if so desired. There are also a few experimental gimmicks, such as the capatibility to generate Thrift IDL files from existing D types at compile time. Soon to come:</p> <ul> <li><p><em>Unix domain sockets:&nbsp;</em> Currently, the D implementation only supports IPv4 and IPv6 TCP sockets, because that is what the D standard library does, but starting with the next release, it will also support Unix domain sockets (if really needed, the lack of support in `std.socket` could be worked around without much effort, though).</p></li> <li><p><code>@safe</code><em>-ty annotations:&nbsp;</em> The D language features built-in memory safety annotations. The majority of the methods in the D Thrift library should be memory safe (except for e.g. `TTransport.borrow`), so marking it as such allowed Thrift to be used in D programs where safety is enforced without requiring the user to mark the Thrift calls as `@trusted`.</p></li> </ul> <p>So, how to get started? As said above, the source code has been mergerd from my <a href="https://github.com/dnadlinger/thrift">personal GitHub repo</a> to the <code>trunk</code> of the <a href="http://thrift.apache.org/developers/">main ASF repo</a>, and as soon as the currently ongoing rework of the official Thrift site is completed, the <a href="https://github.com/dnadlinger/thrift/wiki/Getting-Started-with-Thrift-and-D">Getting Started with Thrift and D</a> and <a href="https://github.com/dnadlinger/thrift/wiki/Building-Thrift-D-on-Windows">Building Thrift/D on Windows</a> pages will follow along. A recent build of the <a href="http://www.klickverbot.at/code/gsoc/thrift/docs/">API docs</a> is currently available here on my website. If you find any bugs, be sure to file them at the <a href="https://issues.apache.org/jira/browse/THRIFT">Thrift JIRA</a>.</p> <footer> Like what you read? <a href="http://twitter.com/?status=@dnadlinger:">Let me know</a> what you think or <a href="http://twitter.com/?status=Just read »Thrift now officially supports D!« by @dnadlinger: http://klickverbot.at/blog/2012/03/thrift-now-officially-supports-d/">share the article</a> on Twitter. Also, there is more on <a href="/blog/tags/D/" title="View all posts tagged with »D«" rel=tag>D</a>, <a href="/blog/tags/GSoC/" title="View all posts tagged with »GSoC«" rel=tag>GSoC</a> and <a href="/blog/tags/Thrift/" title="View all posts tagged with »Thrift«" rel=tag>Thrift</a>. </footer> </div> </article> </div> <footer id=main_footer> <ul> <li><a class=twitter href="//twitter.com/dnadlinger">Follow me on Twitter</a></li> <li><a class=mail href="/about">Contact me</a></li> <li><a class=rss href="/blog/atom.xml">Blog feed</a></li> </ul> </footer> </body> </html>