<!doctype html> <html lang=en> <head> <meta charset=utf-8> <link rel=stylesheet href='/css/250adbc.css'> <title>git reset using Mercurial | David Nadlinger</title> <meta name=viewport content="width=device-width; initial-scale=1.0"> <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML'></script> <link rel="openid.server" href="http://openid.klickverbot.at/"/> <link rel="openid2.provider" href="http://openid.klickverbot.at/"/> </head> <body> <header id=main_header> <h1><span><a href="/">David Nadlinger</a></span></h1> <nav role=navigation> <ul> <li><a href="/blog">Blog</a></li> <li><a href="/code">Code</a></li> <li><a href="/about">About</a></li> </ul> </nav> </header> <div role=main id=main_content> <article class=blog-post> <header> <h1><a href="/blog/2011/01/git-reset-using-mercurial/">git reset using Mercurial</a></h1> <section class=metadata> on <time datetime="2011-01-09T00:00:00+00:00">09 Jan 2011</time> </section> <ul class=pagenav> <li><a href="/blog/2010/12/swig-d-breaking-name-changes/">Older</a></li> <li><a href="/blog/2011/02/swig-2-0-2-with-d-support-released/">Newer</a></li> </ul> </header> <div class=content> <p>I am mainly a <a href="http://git-scm.com">Git</a> user, but lately I have been working with <a href="http://mercurial.selenic.com/">Mercurial</a> from time to time. I have been mostly using it for basic committing though, so I still occasionally end up with a commit I did not mean to create like this when performing more advanced operations. But undoing that can&#8217;t be too hard, right?</p> <p>For example, I recently toyed around with <a href="http://mercurial.selenic.com/wiki/MqExtension">Mercurial Queues</a> to emulate Git&#8217;s staging area, one of the features that seem trivial, but which you don&#8217;t want to miss at any cost once you are used to it. Doing so, while being at, let&#8217;s say, revision <code>1000</code>, I accidentally created two changesets, <code>1001</code> and <code>1002</code>. Now, how do I get rid of these while still keeping the contents of them in the working copy? Using Git, this would just be <code>git reset HEAD~2</code>. But unfortunately, Mercurial seems to make your life somewhat hard in this case, this is what I came up with (please leave me a message in the comments in case I missed an easier way):</p> <figure class=code> <div class=highlight><pre>hg update -r1000<br />
</pre></div></figure> <p>This sets the working copy to the last »good« revision, only to …</p> <figure class=code> <div class=highlight><pre>hg revert &#8212;all -r1002<br />
</pre></div></figure> <p>… bring the changes from the two commits back to the working copy (but without committing them this time), so we can now …</p> <figure class=code> <div class=highlight><pre>hg strip &#8212;force 1001<br />
</pre></div></figure> <p>… strip the two changesets from the history.</p> <p>I am perfectly aware of the fact that any other <span class=caps>SCM</span> tool will probably seem clumsy at first if I am used to Git (besides the fact that Git seems to be a natural fit for the way I think about versioning), but I still wonder whether there a deeper reason for Mercurial not to support this more directly.</p> <footer> Like what you read? <a href="http://twitter.com/?status=@dnadlinger:">Let me know</a> what you think or <a href="http://twitter.com/?status=Just read »git reset using Mercurial« by @dnadlinger: http://klickverbot.at/blog/2011/01/git-reset-using-mercurial/">share the article</a> on Twitter. Also, there is more on <a href="/blog/tags/Git/" title="View all posts tagged with »Git«" rel=tag>Git</a>. </footer> </div> </article> </div> <footer id=main_footer> <ul> <li><a class=twitter href="//twitter.com/dnadlinger">Follow me on Twitter</a></li> <li><a class=mail href="/about">Contact me</a></li> <li><a class=rss href="/blog/atom.xml">Blog feed</a></li> </ul> </footer> </body> </html>