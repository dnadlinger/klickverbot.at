<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 <title>David Nadlinger</title>
 <link href="http://klickverbot.at/blog/tags/Linux/atom.xml" rel="self"/>
 <link href="http://klickverbot.at/"/>
 <updated>2023-07-06T14:46:30-04:00</updated>
 <id>http://klickverbot.at/blog/tags/Linux/</id>
 <author>
   <name>David Nadlinger</name>
   <email>atom@klickverbot.at</email>
 </author>

 
 <entry>
   <title>Systemd units for Buildbot in Conda</title>
   <link href="http://klickverbot.at/blog/2018/08/buildbot-conda-systemd-units/"/>
   <updated>2018-08-25T00:00:00-04:00</updated>
   <id>http://klickverbot.at/blog/2018/08/buildbot-conda-systemd-units</id>
   <content type="html">&lt;p&gt;Buildbot is a Python framework for continuous integration systems. In &lt;a href=&quot;https://www2.physics.ox.ac.uk/research/ion-trap-quantum-computing-group&quot;&gt;my research group&lt;/a&gt; we are deploying it in a &lt;a href=&quot;https://conda.io/&quot;&gt;Conda&lt;/a&gt; environment, which we also use to manage all the different moving parts of our Python-centric control infrastructure on both Windows and Linux. To start up the master and worker services, the corresponding Conda environment needs to be activated first. This is easiest to achieve using simple wrapper scripts.&lt;/p&gt;

&lt;p&gt;For this, let’s assume we’ve created a &lt;code&gt;bb&lt;/code&gt; user, with the master and worker configurations in its home directory (&lt;code&gt;~/master&lt;/code&gt; and &lt;code&gt;~/worker&lt;/code&gt;). First, create a wrapper script to start up the master process:&lt;/p&gt;

&lt;figure class=&quot;code&quot;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; -eo pipefail

&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~/anaconda3/bin:&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;source &lt;/span&gt;activate buildbot
buildbot start --nodaemon master
&lt;/pre&gt;&lt;/div&gt;&lt;figcaption&gt;&lt;span&gt;~bb/start-master.sh &lt;/span&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;This assumes Conda has been installed into &lt;code&gt;~bb/anaconda3&lt;/code&gt;, and the environment with the Buildbot installation is called &lt;code&gt;buildbot&lt;/code&gt;. &lt;code&gt;master&lt;/code&gt; is the name of the configuration directory, and &lt;code&gt;--nodaemon&lt;/code&gt; prevents daemonisation (i.e. keeps the process running in the foreground).&lt;/p&gt;

&lt;p&gt;Make the script executable, and create a Systemd unit file that invokes it:&lt;/p&gt;

&lt;figure class=&quot;code&quot;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;[Unit]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Buildbot master service&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;After&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;network.target&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;[Service]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;bb&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;bb&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;WorkingDirectory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/home/bb&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;ExecStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/home/bb/start-master.sh&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;ExecReload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/bin/kill -HUP $MAINPID&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;[Install]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;WantedBy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;figcaption&gt;&lt;span&gt;/etc/systemd/system/buildbot-master.service &lt;/span&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;To start the master process, run&lt;/p&gt;

&lt;figure class=&quot;code&quot;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;systemctl start buildbot-master
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;and to do so every time the system boots:&lt;/p&gt;

&lt;figure class=&quot;code&quot;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;buildbot-master
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;hr /&gt;

&lt;p&gt;The analogous configuration for the worker process is&lt;/p&gt;

&lt;figure class=&quot;code&quot;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; -eo pipefail

&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~/anaconda3/bin:&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;source &lt;/span&gt;activate buildbot
buildbot-worker start --nodaemon worker
&lt;/pre&gt;&lt;/div&gt;&lt;figcaption&gt;&lt;span&gt;~bb/start-worker.sh &lt;/span&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;figure class=&quot;code&quot;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;[Unit]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Buildbot worker service&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;After&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;network.target&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;[Service]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;bb&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;bb&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;WorkingDirectory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/home/bb&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;ExecStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/home/bb/start-worker.sh&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;ExecReload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/bin/kill -HUP $MAINPID&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;[Install]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;WantedBy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;figcaption&gt;&lt;span&gt;/etc/systemd/system/buildbot-worker.service &lt;/span&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Start it using&lt;/p&gt;

&lt;figure class=&quot;code&quot;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;buildbot-worker
systemctl start buildbot-worker
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;hr /&gt;

&lt;p&gt;This is it; Buildbot is now run automatically when the system boots. To avoid starting the graphical user interface on a desktop Ubuntu install, run &lt;code&gt;systemctl set-default multi-user.target&lt;/code&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Setting up GDC and Tango on Linux x86</title>
   <link href="http://klickverbot.at/blog/2009/10/setting-up-gdc-and-tango-on-linux-x86/"/>
   <updated>2009-10-26T00:00:00-04:00</updated>
   <id>http://klickverbot.at/blog/2009/10/setting-up-gdc-and-tango-on-linux-x86</id>
   <content type="html">Currently, there are three more-or-less working compilers for the &quot;D programming language&quot;:http://digitalmars.com/d/ (version 1): The oldest and most mature one is DMD, short for Digital Mars D Compiler, the official reference implementation by Walter Bright, the creator of D. It has grown reasonably stable, but has certain limitations, most of them resulting from using a proprietary back-end. Additionally, not all parts of it are Open Source (starting with a capital letter). The second one is &lt;a href=&quot;http://dsource.org/projects/ldc&quot;&gt;LDC&lt;/a&gt;, a rather young, but quick-moving project which aims to port the front-end of DMD to the also fairly recent &lt;a href=&quot;http://llvm.org&quot;&gt;LLVM&lt;/a&gt; compiler framework in order to leverage its advanced code generation and optimization infrastructure. While it still has some bugs to iron out (most notably missing exception support on Windows), it works reasonably well on Linux x86 (32 and 64&amp;nbsp;bit). The third compiler, and subject of interest for this post, is GDC. Like the other two compilers, it uses the Digital Mars D front-end, but coupled to the very mature GNU Compiler Collection (GCC) back-end, whose C/C++ compiler is widely used on Unix-like systems like Linux, Mac OS X, various flavors of BSD and also Windows through &lt;a href=&quot;http://mingw.org&quot;&gt;MinGW&lt;/a&gt;. Unfortunately, development on it has stalled, making it pretty much unusable due to the many bugs the old DMD front-end it uses contains.

However, there has been an effort started to resurrect GDC recently. Development takes place over at &lt;a href=&quot;http://bitbucket.org/goshawk/gdc&quot;&gt;bitbucket&lt;/a&gt; (you can also find building instructions for GDC there) and the project has been able to celebrate some first success: The reasonably recent front-end versions 1.040 and 2.015 (for D2) are working with GCC 4.3. This seemed enough of a sign of life for me to decide to give GDC another try. After some initial problems (some of which resulted from bugs which have already been fixed in the official Mercurial repository) I managed to compile a GDC binary (frontend version 1.040 against GCC 4.3.1) which happily compiles the &lt;a href=&quot;http://dsource.org/projects/tango&quot;&gt;Tango&lt;/a&gt; standard library and a personal project of mine. This is what I did (silently omitting quite a few hours of searching and fixing bugs): &lt;!--more--&gt;

First, go to some temporary directory and checkout the GDC sources from the Mercurial repository (at the time of writing, revision 53 was current):

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/tmp
hg clone http://bitbucket.org/goshawk/gdc
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

Then, download the core of GCC 4.3.1 from a &lt;a href=&quot;http://gcc.gnu.org/mirrors.html&quot;&gt;mirror near you&lt;/a&gt; (version 4.3.2 should also work, but builds against 4.3.4 are currently known to be broken) and extract it inside the GDC sources:

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;wget ftp://gd.tuwien.ac.at/gnu/gcc/releases/gcc-4.3.1/gcc-core-4.3.1.tar.bz2
mkdir gdc/dev
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;gdc/dev
tar xjvf ../../gcc-core-4.3.1.tar.bz2
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

Now, link the GDC sources into the extracted directory and use the provided [@setup-gcc.sh@] script to patch GCC to enable D version 1:

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;gcc-4.3.4
ln -s ../../../d gcc/d
gcc/d/setup-gcc.sh --d-language-version&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

After that, you are ready to build and install GCC with D support. For this, go to some build directory and [@configure@] and [@make@]. You can, of course, choose an arbitrary directory for the build files (for instance, I personally prefer having the build files completely outside the source direcotry):

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;mkdir build
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;build
../configure --enable-languages&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;d --disable-multilib --disable-shared --prefix&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/opt/gdc
make
sudo make install
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

Note that I configured GCC/GDC to be installed in [@/opt/gdc@]. As the build also includes the C compiler, this avoids any interference with the »normal« GCC installed probably in [@/usr@]. After the build has finished – this takes quite long, since GCC is built three times to bootstrap itself – you should have a working GDC executable in [@/opt/gdc/bin@]. Now for the second part, Tango:

Start off by fetching the Tango sources from the SVN to a temporary working directory (I worked with revision 5023):

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/tmp
svn co http://svn.dsource.org/projects/tango/trunk tango
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

Unfortunately, Tango currently does not compile with GDC out of the box, you have to apply a couple of minor changes: The first change adds build/arch files for GDC/Linux:

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;gh&quot;&gt;diff --git a/build/arch/linux-i686-gdc-dbg.mak b/build/arch/linux-i686-gdc-dbg.mak&lt;/span&gt;
&lt;span class=&quot;gd&quot;&gt;--- /dev/null&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ b/build/arch/linux-i686-gdc-dbg.mak&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -0,0 +1,6 @@&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+include $(ARCHDIR)/gdc.rules&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+include $(ARCHDIR)/linux.inc&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+# -Wall breaks the compilation with wrong errors&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+DFLAGS_COMP=-g&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+CFLAGS_COMP=-g&lt;/span&gt;

&lt;span class=&quot;gh&quot;&gt;diff --git a/build/arch/linux-i686-gdc-opt.mak b/build/arch/linux-i686-gdc-opt.mak&lt;/span&gt;
&lt;span class=&quot;gd&quot;&gt;--- /dev/null&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ b/build/arch/linux-i686-gdc-opt.mak&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -0,0 +1,5 @@&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+include $(ARCHDIR)/gdc.rules&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+include $(ARCHDIR)/linux.inc&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+DFLAGS_COMP=-O2&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+CFLAGS_COMP=-O2&lt;/span&gt;

&lt;span class=&quot;gh&quot;&gt;diff --git a/build/arch/linux-i686-gdc-tst.mak b/build/arch/linux-i686-gdc-tst.mak&lt;/span&gt;
&lt;span class=&quot;gd&quot;&gt;--- /dev/null&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ b/build/arch/linux-i686-gdc-tst.mak&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -0,0 +1,5 @@&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+include $(ARCHDIR)/gdc.rules&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+include $(ARCHDIR)/linux.inc&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+DFLAGS_COMP=-g -fdeprecated -fdebug=UnitTest -funittest&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+CFLAGS_COMP=-g&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;
The second change removes the [@-fversion=Posix@] flag from the Makefile of the runtime because the DMD frontend GDC currently uses (1.040) does not allow it to be specified as it is set automatically (this restriction has been lifted in later versions):

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;gh&quot;&gt;diff --git a/runtime/compiler/gdc/Makefile.am b/runtime/compiler/gdc/Makefile.am&lt;/span&gt;
&lt;span class=&quot;gd&quot;&gt;--- a/runtime/compiler/gdc/Makefile.am&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ b/runtime/compiler/gdc/Makefile.am&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -18,7 +18,7 @@&lt;/span&gt;
 # AUTOMAKE_OPTIONS = 1.9.6 foreign no-dependencies

 OUR_CFLAGS=@DEFS@ -I.
&lt;span class=&quot;gd&quot;&gt;-D_EXTRA_DFLAGS=-nostdinc -pipe -I../../.. -I../shared -fversion=Posix&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+D_EXTRA_DFLAGS=-nostdinc -pipe -I../../.. -I../shared&lt;/span&gt;
 ALL_DFLAGS = $(DFLAGS) $(D_MEM_FLAGS) $(D_EXTRA_DFLAGS) $(MULTIFLAGS)

 host_alias=.
&lt;span class=&quot;gh&quot;&gt;diff --git a/runtime/compiler/gdc/Makefile.in b/runtime/compiler/gdc/Makefile.in&lt;/span&gt;
&lt;span class=&quot;gd&quot;&gt;--- a/runtime/compiler/gdc/Makefile.in&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ b/runtime/compiler/gdc/Makefile.in&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -228,7 +228,7 @@ target_vendor = @target_vendor@&lt;/span&gt;
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 OUR_CFLAGS = @DEFS@ -I.
&lt;span class=&quot;gd&quot;&gt;-D_EXTRA_DFLAGS = -nostdinc -pipe -I../../.. -I../shared -fversion=Posix&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+D_EXTRA_DFLAGS = -nostdinc -pipe -I../../.. -I../shared&lt;/span&gt;
 ALL_DFLAGS = $(DFLAGS) $(D_MEM_FLAGS) $(D_EXTRA_DFLAGS) $(MULTIFLAGS)
 toolexecdir = $(phobos_toolexecdir)
 toolexeclibdir = $(phobos_toolexeclibdir)
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;
The third and last change adds a workaround to Tango&apos;s user library for a bug in the DMD front-end which has been fixed by now (the compiler fails to resolve the type of the template parameter in the templated [@intpow@] function):

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;gh&quot;&gt;diff --git a/user/tango/math/internal/BiguintCore.d b/user/tango/math/internal/BiguintCore.d&lt;/span&gt;
&lt;span class=&quot;gd&quot;&gt;--- a/user/tango/math/internal/BiguintCore.d&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ b/user/tango/math/internal/BiguintCore.d&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -516,7 +516,7 @@ static BigUint pow(BigUint x, ulong y)&lt;/span&gt;
             }
             y0 = y/p;
             finalMultiplier = intpow(x0, y - y0*p);
&lt;span class=&quot;gd&quot;&gt;-            x0 = intpow(x0, p);&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+            x0 = intpow!(BigDigit)(x0, p);&lt;/span&gt;
         }
         xlength = 1;
     }
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

After you have applied these patches, you should be ready to build Tango (make sure that you have a [@cc@] somewhere in your [@PATH@], if not, create a link to your system&apos;s [@gcc@]):

&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;sudo &lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;:/opt/gdc/bin &lt;span class=&quot;nv&quot;&gt;DC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;gdc build/build.sh --lib-install-dir /opt/gdc/lib
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;
However, I had to remove Phobos&apos; [@object.d@] from [@/opt/gdc/include/d/4.3.1@] first. [@build/build.sh@] should finish with a note reminding you that the user libraries still have to be installed. To do this, simply copy the contents of the [@user@] directory to [@/opt/gdc/include/d/4.3.1@] after removing the old include files which are part of Phobos (you have to keep the [@gcc@] and [@i686-pc-linux-gnu@] directories though). Congratulations, now you should be able to build your Tango projects with GDC!

A quick tip for &lt;a href=&quot;http://www.dsource.org/projects/dsss/&quot;&gt;DSSS&lt;/a&gt; users: You probably have to modify your [@gdc-posix-tango@] profile to omit the [@-version=Posix@] switch (see above) on [@gdmd@] calls and add [@-L-ltango-base-gdc@] to the linker flags since Tango was not installed via DSSS in the above instructions.

p(update). Since I originally wrote this post, Tango&apos;s build system was modified yet another time (at least, things are much simpler now). Instead of fiddling around with the makefiles, just use the [@bob@] tool from the [@build@] directory now which _should_ work with GDC out of the box.
</content>
 </entry>
 
 <entry>
   <title>Installing DMD, LDC, Tango and DSSS on (K)Ubuntu Jaunty</title>
   <link href="http://klickverbot.at/blog/2009/07/installing-dmd-ldc-tango-and-dsss-on-kubuntu-jaunty/"/>
   <updated>2009-07-28T00:00:00-04:00</updated>
   <id>http://klickverbot.at/blog/2009/07/installing-dmd-ldc-tango-and-dsss-on-kubuntu-jaunty</id>
   <content type="html">For quite a while now, I am using the &lt;a href=&quot;http://en.wikipedia.org/wiki/D_(programming_language)&quot;&gt;D programming language&lt;/a&gt;, version 1 (I have not looked at D2 yet, it is said to be still rather unstable). Even though I like it very much for its syntactical quality and the language itself is reasonably mature, I must admit that setting up the toolchain correctly can still be a very cumbersome task to do, especially when you are new to D.

This post describes an installation routine that should provide you with a working D development environment containing DMD, LDC, Tango and DSSS on (K)Ubuntu Jaunty. Please note that it assumes your system to be »clean« – if you have already installed any D-related software, it is probably advisable to remove it completely to prevent any problems with, for instance, stale files. &lt;!--more--&gt;


&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;mkdir -p ~/tmp
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/tmp

wget http://ftp.digitalmars.com/dmd.1.050.zip
unzip dmd.1.050.zip
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;dmd/linux/bin/
chmod +x dmd dumpobj obj2asm rdmd
sudo cp dmd dmd.conf dumpobj obj2asm rdmd /usr/local/bin/

&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/tmp
svn co http://svn.dsource.org/projects/tango/trunk tango

&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;tango/
sudo &lt;span class=&quot;nv&quot;&gt;DC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dmd build/build.sh --lib-install-dir /usr/local/lib
sudo cp -rf user/object.di user/rt user/std user/tango /usr/local/include/d/

sudo su -c &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo -e &amp;quot;[Environment]\nDFLAGS=-I/usr/local/include/d -defaultlib=tango-base-dmd -debuglib=tango-base-dmd -L-ltango-user-dmd -version=Tango -version=Posix&amp;quot; &amp;gt; /usr/local/bin/dmd.conf&amp;#39;&lt;/span&gt;

sudo su -c &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo -e &amp;quot;# dsss\ndeb http://ppa.launchpad.net/d-language-packagers/ppa/ubuntu jaunty main&amp;quot; &amp;gt;&amp;gt; /etc/apt/sources.list&amp;#39;&lt;/span&gt;
sudo apt-get install dsss
sudo su -c &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo &amp;quot;profile=dmd-posix-tango&amp;quot; &amp;gt; /etc/drebuild/default&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

You should now be able to build your D/Tango programs with DMD and DSSS.

I would suggest giving &lt;a href=&quot;http://www.dsource.org/projects/ldc&quot;&gt;LDC&lt;/a&gt; at least a short glance, a fairly young compiler project which leverages &lt;a href=&quot;http://llvm.org/&quot;&gt;LLVM&lt;/a&gt; as its code generating backend. It is maturing very quickly and allows you to make use of the various features the LLVM compiler infrastructure provides, the most noticeable probably being its excellent optimization routines. Fortunately, there are current binary packages available at launchpad, so all that is needed to LDC is:


&lt;figure class=&apos;code&apos;&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;sudo su -c &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo -e &amp;quot;# ldc-daily\ndeb http://ppa.launchpad.net/d-language-packagers/ppa/ubuntu karmic main\ndeb http://archive.ubuntu.com/ubuntu karmic main universe&amp;quot; &amp;gt;&amp;gt; /etc/apt/sources.list&amp;#39;&lt;/span&gt;
sudo apt-get update

sudo apt-get install ldc-daily libtango-ldc-daily-dev

&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/tmp
wget -O ldc-posix-tango http://www.dsource.org/projects/ldc/browser/ldc-posix-tango?format&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;raw
sudo su -c &lt;span class=&quot;s1&quot;&gt;&amp;#39;sed &amp;quot;s:ldc.rebuild.conf:/etc/ldc/ldc.rebuild.conf:&amp;quot;  /etc/drebuild/ldc-posix-tango&amp;#39;&lt;/span&gt;

sudo su -c &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo &amp;quot;profile=ldc-posix-tango&amp;quot; &amp;gt; /etc/drebuild/default&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;

Note that the above commands install a daily snapshot of LDC, which I would recommend to use due to the currently fast development of LDC. In order not to break you Jaunty installation, please _*do not forget* to comment out the official »karmic« repositories_ (which contain some dependencies for [@ldc-daily@]) in your [@/etc/apt/sources.list@] and run [@apt-get update@] after the installation is completed.

Both compilers are set up to use Tango, do _not_ install Tango via DSSS! If you want to switch compilers, just activate the corresponding profile in [@/etc/drebuild/default@] and do not forget to rebuild any D libraries you might have compiled and installed with the old compiler (just run [@dsss net install … @]for the ones you installed using DSSS).

p(update). Since I wrote this post, Tango received yet another big structural change to its codebase (amongst other changes, the core and user libraries have been merged). Now, you should use the supplied _»bob«_ tool now to build tango. Additionally, Karmic is now stable so you might have to adapt the APT repository-related instructions.
</content>
 </entry>
 
 <entry>
   <title>Getting KDE's clippboard to work with Eclipse</title>
   <link href="http://klickverbot.at/blog/2009/05/getting-kdes-clippboard-to-work-with-eclipse/"/>
   <updated>2009-05-28T00:00:00-04:00</updated>
   <id>http://klickverbot.at/blog/2009/05/getting-kdes-clippboard-to-work-with-eclipse</id>
   <content type="html">For whatever reason, Eclipse does not work well with Klipper, the KDE clipboard manager, in its default settings. The symptoms: Quite often, you copy a piece of text to the clipboard. When you try to paste it, it miraculously disappears and some old piece of clipboard content is pasted instead.

After simply trying to ignore the problem for some time, I searched and found a solution today: You have to disable the _»Prevent empty clipboard«_ setting in Klipper&apos;s configuration menu (which is accessible by right-clicking on the systray icon).

Intuitive? Not to me…

p(update). Disabling the mentioned option might introduce some minor glitches to general clipboard usage (sometimes, the clipboard seems to empty itself). As those occur rather infrequently, I have not been able to find out why this happens, or even if this is connected to the configuration changes described in this post.
</content>
 </entry>
 
 <entry>
   <title>Duplicate »Translucency« KWin effect</title>
   <link href="http://klickverbot.at/blog/2009/04/duplicate-translucency-kwin-effect/"/>
   <updated>2009-04-28T00:00:00-04:00</updated>
   <id>http://klickverbot.at/blog/2009/04/duplicate-translucency-kwin-effect</id>
   <content type="html">For some time, the effect »Translucency« was listed twice in the KWin KCM plugin list of my local KDE setup (SVN trunk). One copy was actually working, the other was just producing error messages.

Today, I finally had time to investigate the issue: The problem was caused by a stale [@.desktop@] file in [@share/kde4/services/kwin@] with the old name of the plugin (it was renamed from _maketransparent_ to _translucency_).

I have no idea how this could happen, because I usually purge the whole [@/opt/kde@] folder everytime I [@svn up@] my [@qt-copy@], which I happen to do quite often…
</content>
 </entry>
 
 <entry>
   <title>KHotkeys in KDE 4.1</title>
   <link href="http://klickverbot.at/blog/2008/11/khotkeys-in-kde-4-1/"/>
   <updated>2008-11-02T00:00:00-04:00</updated>
   <id>http://klickverbot.at/blog/2008/11/khotkeys-in-kde-4-1</id>
   <content type="html">I just upgraded to Kubuntu 8.10 in order to have a look at shiny new KDE 4. But amongst other minor annoyances, I had real trouble getting hotkeys to work. There are configuration options in the new System Settings panel (which is a huge regression compared to KControl by the way), but they seemed to have no effect.

After various attempts of fixing this problem myself, I finally found a (slightly hackish) solution: &quot;Re: Does khotkeys work on your KDE 4.1?&quot;:http://ubuntuforums.org/showpost.php?p=5541572&amp;postcount=9. Seems like KDE 4.1 is still _very_ beta...
</content>
 </entry>
 
 <entry>
   <title>KDE Konsole corruption when Compiz is active</title>
   <link href="http://klickverbot.at/blog/2008/09/kde-konsole-corruption-when-compiz-is-active/"/>
   <updated>2008-09-03T00:00:00-04:00</updated>
   <id>http://klickverbot.at/blog/2008/09/kde-konsole-corruption-when-compiz-is-active</id>
   <content type="html">On my laptop I&apos;m currently running Kubuntu 8.04 (Hardy Heron). For additional eye candy goodness I am using the [@compiz-fusion@] package from the Kubuntu repositories. Surprisingly, even on the laptop hardware (Asus V1S) everything went smooth out of the box – I could even manage to find some drivers for the webcam and for the finger print scanner.

Well, everything worked fine except for one little detail: When I had an active Konsole session on one cube face, for example a log file, and continued to work on another side of the cube, the Konsole output would often be broken when I switched back to it. It would look as if the output had been scrolled, but the non-scrolled output hadn&apos;t been cleared from the window. This problem could be fixed by forcing the window to refresh, e.g. by switching to another (Konsole) tab.

In their 169.XX driver series, nVidia added a config option called [@UseCompositeWrapper@], which can help to sort out this kind of redraw problems. Fortunately, enabling this via adding the following line to the [@Device@] section of my [@xorg.conf@] was enough to solve the problem:

bc. Option &quot;UseCompositeWrapper&quot; &quot;true&quot;
</content>
 </entry>
 
</feed>
